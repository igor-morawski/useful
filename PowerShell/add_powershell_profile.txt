# touch profile file if none exists
if (!(Test-Path -Path $PROFILE ))
{ New-Item -Type File -Path $PROFILE -Force }

# modify the File
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...


$_ = Get-ExecutionPolicy; if ($_ -eq "Restricted") {Set-ExecutionPolicy AllSigned}

#New-SelfSignedCertificate -CertStoreLocation cert:\currentuser\my ` -Subject "CN=Local Code Signing" ` -KeyAlgorithm RSA ` -KeyLength 2048 ` -Provider "Microsoft Enhanced RSA and AES Cryptographic Provider" ` -KeyExportPolicy Exportable ` -KeyUsage DigitalSignature ` -Type CodeSigningCert

$cert=(dir cert:currentuser\my\ -CodeSigningCert)
Set-AuthenticodeSignature -FilePath $Profile -Certificate $cert
