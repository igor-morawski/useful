# touch profile file if none exists
if (!(Test-Path -Path $PROFILE ))
{ New-Item -Type File -Path $PROFILE -Force }

# modify the File
# ...
# ...
# ...
# ...
# ...
# ...
# ...
# ...

$_ = Get-ExecutionPolicy; if ($_ -eq "Restricted") {Set-ExecutionPolicy AllSigned}

$cert=(dir cert:currentuser\my\ -CodeSigningCert)
Set-AuthenticodeSignature -FilePath $Profile -Certificate $cert